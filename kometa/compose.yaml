services:
  kometa:
    container_name: kometa
    hostname: kometa
    image: kometateam/kometa:latest
    environment:
      - PUID=${ENV_PUID}
      - PGID=${ENV_PGID}
      - TZ=${TIMEZONE}
      - KOMETA_CONFIG=/config/config.yml #optional
      - KOMETA_TIME=04:30 #optional
      - KOMETA_DEBUG=True
      - KOMETA_NO_MISSING=False #optional
      - KOMETA_NO_COUNTDOWN=True
      # - KOMETA_RUN=True
    volumes:
      - /mnt/cache/appdata/Kometa:/config
      - /mnt/cache/appdata/posterizarr/assets/:/config/assets
    restart: unless-stopped
    networks:
      - frontend
      - backend
    security_opt:
      - no-new-privileges:true
  imagemaid:
    container_name: imagemaid
    hostname: imagemaid
    image: kometateam/imagemaid:develop
    environment:
      - TZ=${TIMEZONE}
      - PLEX_URL=http://plex:32400
      - PLEX_TOKEN=${PLEX_TOKEN}
      - MODE=remove
      - LOCAL_DB=False
      - IGNORE_RUNNING=False
      - USE_EXISTING=False
      - PHOTO_TRANSCODER=True
      - EMPTY_TRASH=True
      - CLEAN_BUNDLES=True
      - OPTIMIZE_DB=True
      - TIMEOUT=600
      - SLEEP=60
      - TRACE=False
      - LOG_REQUESTS=False
      - SCHEDULE=07:00|weekly(wednesday)
    volumes:
      - /mnt/cache/appdata/ImageMaid:/config
      - /mnt/cache/appdata/Plex-Media-Server/:/plex
    restart: unless-stopped
    networks:
      - backend
    security_opt:
      - no-new-privileges:true
networks:
  backend:
    external: true
  frontend:
    external: true
